(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[276],{3219:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(4297).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},5077:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(4297).Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},4464:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(4297).Z)("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},7764:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(4297).Z)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},9560:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(4297).Z)("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]])},3454:function(e,t,s){"use strict";var a,r;e.exports=(null==(a=s.g.process)?void 0:a.env)&&"object"==typeof(null==(r=s.g.process)?void 0:r.env)?s.g.process:s(7663)},3639:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/history",function(){return s(4227)}])},2798:function(e,t,s){"use strict";s.d(t,{y:function(){return i}}),s(7294);let a=s(3454).env.NEXT_PUBLIC_API_URL||"http://localhost:8011/api";class r{async request(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s="".concat(a).concat(e),r={headers:{"Content-Type":"application/json"},...t};try{let e=await fetch(s,r);if(!e.ok)throw Error("HTTP error! status: ".concat(e.status));return await e.json()}catch(e){throw console.error("API request failed:",e),e}}async healthCheck(){return this.request("/health")}async createReading(e){return this.request("/reading",{method:"POST",body:JSON.stringify(e)})}async getSpreads(){let e=await this.request("/spreads");return{success:e.success,data:e.spreads}}async getSpreadDetail(e){return this.request("/spreads/".concat(e))}async getCards(e){let t=e?"?search=".concat(encodeURIComponent(e)):"",s=await this.request("/cards".concat(t));return{success:s.success,data:s.cards}}async getReadingHistory(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=new URLSearchParams;e.limit&&t.append("limit",e.limit.toString()),e.offset&&t.append("offset",e.offset.toString());let s=t.toString(),a=await this.request("/history".concat(s?"?".concat(s):""));return{success:a.success,data:{readings:a.readings,total:a.total,limit:a.limit,offset:a.offset}}}async getStatistics(){let e=await this.request("/statistics");return{success:e.success,data:e.statistics}}async recommendSpread(e){return this.request("/recommend-spread",{method:"POST",body:JSON.stringify({question:e})})}}let i=new r},4227:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return w}});var a=s(5893),r=s(7294),i=s(9008),n=s.n(i),c=s(1664),l=s.n(c),o=s(3495),d=s(3219),u=s(9560),m=s(5077),x=s(4297);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let h=(0,x.Z)("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);var y=s(7764);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let p=(0,x.Z)("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]),g=(0,x.Z)("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]);var f=s(4464);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let v=(0,x.Z)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);var j=s(2798);let b=e=>({single:"单张牌占卜",three_card:"三张牌占卜",celtic_cross:"凯尔特十字"})[e]||e,N=e=>({single:1,three_card:3,celtic_cross:10})[e]||1;var w=()=>{let[e,t]=(0,r.useState)([]),[s,i]=(0,r.useState)([]),[c,x]=(0,r.useState)("all"),[w,_]=(0,r.useState)(""),[k,T]=(0,r.useState)(null),[q,D]=(0,r.useState)(!0),[Z,C]=(0,r.useState)(1);(0,r.useEffect)(()=>{(async()=>{D(!0);try{var e;let s=await j.y.getReadingHistory(),a=((null===(e=s.data)||void 0===e?void 0:e.readings)||[]).map(e=>({id:e.id,question:e.user_question,question_category:e.question_category,spread_type:e.spread_type,spread_name:b(e.spread_type),reading_summary:e.reading_summary,timestamp:e.timestamp,cards_count:N(e.spread_type)}));t(a)}catch(e){t([{id:"1",question:"我的事业发展如何？",question_category:"career",spread_type:"three_card",spread_name:"三张牌占卜",reading_summary:"事业运势上升，需要把握时机",timestamp:"2024-08-13T10:30:00Z",cards_count:3},{id:"2",question:"这段感情的未来走向？",question_category:"love",spread_type:"celtic_cross",spread_name:"凯尔特十字",reading_summary:"感情稳定发展，需要更多沟通",timestamp:"2024-08-12T15:45:00Z",cards_count:10},{id:"3",question:"今日运势如何？",question_category:"general",spread_type:"single",spread_name:"单张牌占卜",reading_summary:"保持积极心态，好运将至",timestamp:"2024-08-11T08:20:00Z",cards_count:1},{id:"4",question:"应该换工作吗？",question_category:"career",spread_type:"three_card",spread_name:"三张牌占卜",reading_summary:"时机尚未成熟，继续积累经验",timestamp:"2024-08-10T14:15:00Z",cards_count:3},{id:"5",question:"健康状况需要注意什么？",question_category:"general",spread_type:"single",spread_name:"单张牌占卜",reading_summary:"注意休息，保持身心平衡",timestamp:"2024-08-09T11:30:00Z",cards_count:1}])}D(!1)})()},[]),(0,r.useEffect)(()=>{let t=e;if("all"!==c){if("recent"===c){let e=new Date;e.setDate(e.getDate()-7),t=t.filter(t=>new Date(t.timestamp)>e)}else t=t.filter(e=>e.question_category===c)}w&&(t=t.filter(e=>e.question.toLowerCase().includes(w.toLowerCase())||e.reading_summary.toLowerCase().includes(w.toLowerCase()))),t.sort((e,t)=>new Date(t.timestamp).getTime()-new Date(e.timestamp).getTime()),i(t),C(1)},[e,c,w]);let E=e=>new Date(e).toLocaleDateString("zh-CN",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),S=e=>{switch(e){case"love":return"\uD83D\uDC96";case"career":return"\uD83D\uDCBC";case"general":return"✨";default:return"\uD83D\uDD2E"}},L=e=>{switch(e){case"love":return"text-pink-400";case"career":return"text-blue-400";case"general":return"text-purple-400";default:return"text-gray-400"}},H=Math.ceil(s.length/6),P=s.slice((Z-1)*6,6*Z),M={total:e.length,thisWeek:e.filter(e=>{let t=new Date;return t.setDate(t.getDate()-7),new Date(e.timestamp)>t}).length,byCategory:{love:e.filter(e=>"love"===e.question_category).length,career:e.filter(e=>"career"===e.question_category).length,general:e.filter(e=>"general"===e.question_category).length}};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(n(),{children:[(0,a.jsx)("title",{children:"占卜历史记录 - 神秘塔罗牌占卜师"}),(0,a.jsx)("meta",{name:"description",content:"查看您的塔罗占卜历史记录，回顾过往的指引和洞察"})]}),(0,a.jsx)("main",{className:"min-h-screen py-8",children:(0,a.jsxs)("div",{className:"container-custom",children:[(0,a.jsx)("div",{className:"flex items-center justify-between mb-8",children:(0,a.jsx)(l(),{href:"/",children:(0,a.jsxs)(o.E.button,{whileHover:{scale:1.05,x:-5},className:"btn-secondary flex items-center gap-2",children:[(0,a.jsx)(d.Z,{size:20}),"返回首页"]})})}),(0,a.jsxs)(o.E.div,{initial:{opacity:0,y:50},animate:{opacity:1,y:0},className:"text-center mb-12",children:[(0,a.jsx)("h1",{className:"text-responsive-xl font-mystical font-bold mb-6 text-gradient",children:"占卜历史记录"}),(0,a.jsx)("div",{className:"mystical-divider max-w-32 mx-auto mb-8"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 max-w-4xl mx-auto",children:[(0,a.jsxs)("div",{className:"reading-card p-6 text-center",children:[(0,a.jsx)(u.Z,{className:"w-8 h-8 text-amber-400 mx-auto mb-2"}),(0,a.jsx)("div",{className:"text-2xl font-bold text-white mb-1",children:M.total}),(0,a.jsx)("div",{className:"text-sm text-gray-400",children:"总占卜次数"})]}),(0,a.jsxs)("div",{className:"reading-card p-6 text-center",children:[(0,a.jsx)(m.Z,{className:"w-8 h-8 text-blue-400 mx-auto mb-2"}),(0,a.jsx)("div",{className:"text-2xl font-bold text-white mb-1",children:M.thisWeek}),(0,a.jsx)("div",{className:"text-sm text-gray-400",children:"本周占卜"})]}),(0,a.jsxs)("div",{className:"reading-card p-6 text-center",children:[(0,a.jsx)(h,{className:"w-8 h-8 text-green-400 mx-auto mb-2"}),(0,a.jsx)("div",{className:"text-2xl font-bold text-white mb-1",children:M.byCategory.career}),(0,a.jsx)("div",{className:"text-sm text-gray-400",children:"事业占卜"})]}),(0,a.jsxs)("div",{className:"reading-card p-6 text-center",children:[(0,a.jsx)("div",{className:"text-2xl mb-2",children:"\uD83D\uDC96"}),(0,a.jsx)("div",{className:"text-2xl font-bold text-white mb-1",children:M.byCategory.love}),(0,a.jsx)("div",{className:"text-sm text-gray-400",children:"感情占卜"})]})]})]}),(0,a.jsx)(o.E.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{delay:.2},className:"mb-12",children:(0,a.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,a.jsxs)("div",{className:"relative mb-6",children:[(0,a.jsx)(y.Z,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),(0,a.jsx)("input",{type:"text",placeholder:"搜索占卜记录...",value:w,onChange:e=>_(e.target.value),className:"mystical-input pl-12"})]}),(0,a.jsx)("div",{className:"flex flex-wrap justify-center gap-3",children:[{id:"all",label:"全部",icon:p},{id:"recent",label:"最近一周",icon:m.Z},{id:"love",label:"感情",icon:null},{id:"career",label:"事业",icon:null},{id:"general",label:"综合",icon:null}].map(e=>(0,a.jsxs)("button",{onClick:()=>x(e.id),className:"px-6 py-3 rounded-xl font-semibold transition-all flex items-center gap-2 ".concat(c===e.id?"bg-gradient-to-r from-purple-500 to-blue-600 text-white shadow-lg":"bg-gray-800/50 text-gray-300 hover:bg-gray-700/50"),children:[e.icon&&(0,a.jsx)(e.icon,{className:"w-4 h-4"}),!e.icon&&(0,a.jsx)("span",{children:S(e.id)}),e.label]},e.id))})]})}),q&&(0,a.jsxs)("div",{className:"text-center py-20",children:[(0,a.jsx)("div",{className:"loading-spinner mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-400",children:"加载历史记录中..."})]}),!q&&0===s.length&&(0,a.jsxs)(o.E.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"text-center py-20",children:[(0,a.jsx)("div",{className:"text-6xl mb-6",children:"\uD83D\uDD2E"}),(0,a.jsx)("h3",{className:"text-xl font-bold text-white mb-4",children:"暂无占卜记录"}),(0,a.jsx)("p",{className:"text-gray-400 mb-8",children:w||"all"!==c?"没有找到符合条件的记录":"开始您的第一次塔罗占卜吧"}),(0,a.jsx)(l(),{href:"/reading",children:(0,a.jsxs)(o.E.button,{whileHover:{scale:1.05,y:-2},className:"btn-primary flex items-center gap-3 mx-auto",children:[(0,a.jsx)(u.Z,{className:"w-5 h-5"}),"开始占卜"]})})]}),!q&&P.length>0&&(0,a.jsxs)(o.E.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{delay:.3},children:[(0,a.jsx)("div",{className:"grid-responsive",children:P.map((e,t)=>(0,a.jsxs)(o.E.div,{initial:{opacity:0,y:50},animate:{opacity:1,y:0},transition:{delay:.1*t},className:"history-card group",children:[(0,a.jsxs)("div",{className:"flex items-start gap-3 mb-4",children:[(0,a.jsx)("div",{className:"text-2xl",children:S(e.question_category)}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,a.jsx)("span",{className:"text-xs text-gray-400",children:E(e.timestamp)}),(0,a.jsx)("span",{className:"text-xs px-2 py-1 rounded-full bg-gray-800/50 ".concat(L(e.question_category)),children:e.spread_name})]}),(0,a.jsx)("h3",{className:"font-semibold text-white group-hover:text-amber-300 transition-colors",children:e.question})]})]}),(0,a.jsx)("p",{className:"text-gray-300 text-sm leading-relaxed mb-4 line-clamp-2",children:e.reading_summary}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 text-xs text-gray-400",children:[(0,a.jsx)(g,{className:"w-3 h-3"}),(0,a.jsxs)("span",{children:[e.cards_count," 张牌"]})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("button",{onClick:()=>T(k===e.id?null:e.id),className:"p-2 text-purple-400 hover:text-purple-300 transition-colors",title:"查看详情",children:(0,a.jsx)(f.Z,{className:"w-4 h-4"})}),(0,a.jsx)("button",{className:"p-2 text-red-400 hover:text-red-300 transition-colors",title:"删除记录",children:(0,a.jsx)(v,{className:"w-4 h-4"})})]})]}),k===e.id&&(0,a.jsxs)(o.E.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},className:"mt-4 pt-4 border-t border-purple-500/30",children:[(0,a.jsx)("h4",{className:"text-sm font-semibold text-purple-300 mb-2",children:"完整解读"}),(0,a.jsx)("p",{className:"text-sm text-gray-300 leading-relaxed",children:e.reading_summary}),(0,a.jsxs)("div",{className:"mt-3 text-xs text-gray-400",children:["类别: ",e.question_category," • 牌阵: ",e.spread_name]})]})]},e.id))}),H>1&&(0,a.jsxs)("div",{className:"flex justify-center items-center gap-4 mt-12",children:[(0,a.jsx)("button",{onClick:()=>C(Math.max(1,Z-1)),disabled:1===Z,className:"btn-secondary disabled:opacity-50 disabled:cursor-not-allowed",children:"上一页"}),(0,a.jsx)("div",{className:"flex gap-2",children:Array.from({length:H},(e,t)=>t+1).map(e=>(0,a.jsx)("button",{onClick:()=>C(e),className:"w-10 h-10 rounded-lg font-semibold transition-all ".concat(Z===e?"bg-gradient-to-r from-purple-500 to-blue-600 text-white":"bg-gray-800/50 text-gray-300 hover:bg-gray-700/50"),children:e},e))}),(0,a.jsx)("button",{onClick:()=>C(Math.min(H,Z+1)),disabled:Z===H,className:"btn-secondary disabled:opacity-50 disabled:cursor-not-allowed",children:"下一页"})]})]}),(0,a.jsx)(o.E.div,{initial:{opacity:0,y:50},whileInView:{opacity:1,y:0},viewport:{once:!0},className:"text-center mt-20",children:(0,a.jsxs)("div",{className:"reading-card",children:[(0,a.jsx)("h2",{className:"text-responsive-lg font-mystical font-bold mb-6 text-gradient",children:"继续您的塔罗之旅"}),(0,a.jsx)("p",{className:"text-gray-300 mb-8 leading-relaxed max-w-2xl mx-auto",children:"每一次占卜都是一次自我探索的旅程，让塔罗继续为您指引前路"}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[(0,a.jsx)(l(),{href:"/reading",children:(0,a.jsxs)(o.E.button,{whileHover:{scale:1.05,y:-2},whileTap:{scale:.95},className:"btn-primary flex items-center gap-3",children:[(0,a.jsx)(u.Z,{className:"w-5 h-5"}),"新的占卜"]})}),(0,a.jsx)(l(),{href:"/learn",children:(0,a.jsxs)(o.E.button,{whileHover:{scale:1.05,y:-2},whileTap:{scale:.95},className:"btn-secondary flex items-center gap-3",children:[(0,a.jsx)(f.Z,{className:"w-5 h-5"}),"学习塔罗"]})})]})]})})]})})]})}},7663:function(e){!function(){var t={229:function(e){var t,s,a,r=e.exports={};function i(){throw Error("setTimeout has not been defined")}function n(){throw Error("clearTimeout has not been defined")}function c(e){if(t===setTimeout)return setTimeout(e,0);if((t===i||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(s){try{return t.call(null,e,0)}catch(s){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:i}catch(e){t=i}try{s="function"==typeof clearTimeout?clearTimeout:n}catch(e){s=n}}();var l=[],o=!1,d=-1;function u(){o&&a&&(o=!1,a.length?l=a.concat(l):d=-1,l.length&&m())}function m(){if(!o){var e=c(u);o=!0;for(var t=l.length;t;){for(a=l,l=[];++d<t;)a&&a[d].run();d=-1,t=l.length}a=null,o=!1,function(e){if(s===clearTimeout)return clearTimeout(e);if((s===n||!s)&&clearTimeout)return s=clearTimeout,clearTimeout(e);try{s(e)}catch(t){try{return s.call(null,e)}catch(t){return s.call(this,e)}}}(e)}}function x(e,t){this.fun=e,this.array=t}function h(){}r.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var s=1;s<arguments.length;s++)t[s-1]=arguments[s];l.push(new x(e,t)),1!==l.length||o||c(m)},x.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=h,r.addListener=h,r.once=h,r.off=h,r.removeListener=h,r.removeAllListeners=h,r.emit=h,r.prependListener=h,r.prependOnceListener=h,r.listeners=function(e){return[]},r.binding=function(e){throw Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw Error("process.chdir is not supported")},r.umask=function(){return 0}}},s={};function a(e){var r=s[e];if(void 0!==r)return r.exports;var i=s[e]={exports:{}},n=!0;try{t[e](i,i.exports,a),n=!1}finally{n&&delete s[e]}return i.exports}a.ab="//";var r=a(229);e.exports=r}()}},function(e){e.O(0,[965,774,888,179],function(){return e(e.s=3639)}),_N_E=e.O()}]);